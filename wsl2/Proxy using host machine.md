# Proxy use host machine

Wsl2 can not connect to the host machine using `localhost`,

and the `vEthernet (WSL)` IP  of host machine may changed on system startup.

1. Add an inbound port rule in host machine firewall. Rule profile need to be set to `Public`, since the connection from wsl2 to host is `Public Network`.

2. Add global proxy to wsl2.
    ```bash
    $ nano ~/.profile
    export host_ip=$(cat /etc/resolv.conf | grep nameserver | awk '{ print $2 }')
    export https_proxy="http://${host_ip}:<PROXY_PORT>"
    export http_proxy="http://${host_ip}:<PROXY_PORT>"
    export no_proxy="localhost,127.0.0.1,::1,localhost"
    ```

The content in `/etc/resolv.conf'
```
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateResolvConf = false
nameserver 172.xxx.xxx.1
```
---
From
- [isshiki/WSL2 Proxy Setting - medium](https://isshiki.medium.com/wsl2-proxy-setting-2647a556c5ec)